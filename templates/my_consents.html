{% extends "base.html" %}
{% block content %}

<div class="dashboard">

  <div class="dashboard-header">
    <div>
      {% if status == "pending" %}
        <h1>Consent Requests</h1>
        <p class="welcome-text">Applications waiting for your approval.</p>
      {% else %}
        <h1>Active Consents</h1>
        <p class="welcome-text">Applications currently allowed to access your data.</p>
      {% endif %}
    </div>
  </div>

  <div class="section">

    {% if consents %}
      <div class="dashboard-grid">
        {% for c in consents %}
        <div class="dashboard-card">

          <h3>{{ c.app_name }}</h3>

          <p><strong>Requested Data:</strong> {{ c.allowed_fields }}</p>
          <p><strong>Purpose:</strong> {{ c.purpose }}</p>
          <p><strong>Expiry:</strong> {{ c.expiry }}</p>

          {% if status == "pending" %}
            <div class="action-row">
              <a href="{{ url_for('approve_consent', consent_id=c.id) }}"
                 class="approve-btn">
                 Approve
              </a>
            </div>
          {% else %}
            <div class="action-row">
              <a href="{{ url_for('revoke_consent', consent_id=c.id) }}"
                 class="danger-btn">
                 Revoke Access
              </a>
            </div>
          {% endif %}

        </div>
        {% endfor %}
      </div>

    {% else %}
      <p>No {{ status }} consents found.</p>
    {% endif %}

  </div>

</div>

{% endblock %}